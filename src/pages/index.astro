---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import FocusAreas from '../components/FocusAreas.astro';
import RecentPosts from '../components/RecentPosts.astro';
import { getRecentPosts, getFeaturedPosts } from '../lib/sanity';

// Fetch data from Sanity (will fall back to empty arrays if Sanity is not configured)
let recentPosts = [];
let featuredPosts = [];

try {
  recentPosts = await getRecentPosts();
  featuredPosts = await getFeaturedPosts();
} catch (error) {
  console.log('Sanity not configured or data not available');
}

const displayPosts = featuredPosts.length > 0 ? featuredPosts : recentPosts;
---

<BaseLayout title="Jonathan Stewart - Cloud, AI & Leadership">
  <Hero 
    title="Jonathan Stewart"
    subtitle="Technology Leader & Consultant"
    missionStatement="I am a servant leader who helps businesses bring about cloud efficiencies, AI enablement, and leadership development."
  />
  
  <FocusAreas />
  
  <RecentPosts 
    posts={displayPosts} 
    title={featuredPosts.length > 0 ? "Featured Posts" : "Recent Posts"}
  />

  <!-- CTA Section -->
  <section class="py-16 md:py-24 bg-gradient-to-r from-primary-600 to-primary-800">
    <div class="container-custom text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
        Ready to Transform Your Business?
      </h2>
      <p class="text-xl text-primary-100 mb-8 max-w-2xl mx-auto">
        Let's discuss how cloud efficiencies, AI enablement, and strong leadership can drive your organization forward.
      </p>
      <a 
        href="/contact" 
        class="inline-flex items-center justify-center px-8 py-4 bg-white text-primary-600 font-semibold rounded-lg hover:bg-primary-50 transition-colors"
      >
        Start a Conversation
        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
        </svg>
      </a>
    </div>
  </section>
</BaseLayout>
